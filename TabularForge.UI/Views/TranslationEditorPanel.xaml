<UserControl x:Class="TabularForge.UI.Views.TranslationEditorPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             Background="{DynamicResource EditorBackground}">

    <DockPanel>
        <!-- Toolbar -->
        <Border DockPanel.Dock="Top" Background="{DynamicResource ToolBarBackground}"
                BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1"
                Padding="4,4">
            <WrapPanel>
                <Button Command="{Binding LoadTranslationsCommand}" ToolTip="Reload translations from model"
                        Padding="8,4" Margin="0,0,4,0">
                    <TextBlock Text="Refresh" FontSize="12" />
                </Button>
                <Button Command="{Binding SaveTranslationsCommand}" ToolTip="Save translations to model"
                        Padding="8,4" Margin="0,0,4,0">
                    <TextBlock Text="Save" FontSize="12" />
                </Button>

                <Border Width="1" Background="{DynamicResource SeparatorBrush}" Margin="4,2" />

                <!-- Add Culture -->
                <TextBox Text="{Binding NewCultureCode, UpdateSourceTrigger=PropertyChanged}"
                         Width="80" Margin="4,0" Padding="4,3" FontSize="12"
                         ToolTip="Culture code (e.g. fr-FR, de-DE)" />
                <Button Command="{Binding AddCultureCommand}" ToolTip="Add culture"
                        Padding="8,4" Margin="0,0,4,0">
                    <TextBlock Text="+ Culture" FontSize="12" />
                </Button>

                <Border Width="1" Background="{DynamicResource SeparatorBrush}" Margin="4,2" />

                <!-- Export/Import -->
                <Button Command="{Binding ExportCsvCommand}" ToolTip="Export to CSV"
                        Padding="8,4" Margin="0,0,4,0">
                    <TextBlock Text="Export CSV" FontSize="12" />
                </Button>
                <Button Command="{Binding ExportJsonCommand}" ToolTip="Export to JSON"
                        Padding="8,4" Margin="0,0,4,0">
                    <TextBlock Text="Export JSON" FontSize="12" />
                </Button>
                <Button Command="{Binding ImportJsonCommand}" ToolTip="Import from JSON"
                        Padding="8,4" Margin="0,0,4,0">
                    <TextBlock Text="Import JSON" FontSize="12" />
                </Button>
            </WrapPanel>
        </Border>

        <!-- Filter Bar -->
        <Border DockPanel.Dock="Top" Padding="4,4"
                Background="{DynamicResource PanelBackground}"
                BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="Filter:" VerticalAlignment="Center" Margin="0,0,4,0"
                           Foreground="{DynamicResource SecondaryText}" FontSize="12" />
                <TextBox Text="{Binding FilterText, UpdateSourceTrigger=PropertyChanged}"
                         Width="150" Margin="0,0,8,0" Padding="4,3" FontSize="12" />

                <TextBlock Text="Type:" VerticalAlignment="Center" Margin="0,0,4,0"
                           Foreground="{DynamicResource SecondaryText}" FontSize="12" />
                <ComboBox ItemsSource="{Binding ObjectTypeOptions}"
                          SelectedItem="{Binding SelectedObjectType}"
                          Width="100" Margin="0,0,8,0" FontSize="12" />

                <TextBlock Text="Table:" VerticalAlignment="Center" Margin="0,0,4,0"
                           Foreground="{DynamicResource SecondaryText}" FontSize="12" />
                <ComboBox ItemsSource="{Binding TableNames}"
                          SelectedItem="{Binding SelectedTable}"
                          Width="150" Margin="0,0,8,0" FontSize="12" />

                <!-- Culture removal -->
                <TextBlock Text="Remove:" VerticalAlignment="Center" Margin="8,0,4,0"
                           Foreground="{DynamicResource SecondaryText}" FontSize="12" />
                <ComboBox x:Name="CultureRemoveCombo"
                          ItemsSource="{Binding Cultures}"
                          Width="80" Margin="0,0,4,0" FontSize="12" />
                <Button Command="{Binding RemoveCultureCommand}"
                        CommandParameter="{Binding SelectedItem, ElementName=CultureRemoveCombo}"
                        ToolTip="Remove selected culture"
                        Padding="8,4">
                    <TextBlock Text="X" FontSize="12" Foreground="{DynamicResource ErrorText}" />
                </Button>
            </StackPanel>
        </Border>

        <!-- Status Bar -->
        <Border DockPanel.Dock="Bottom" Padding="4,2"
                Background="{DynamicResource PanelBackground}"
                BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,1,0,0">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding StatusText}" FontSize="11"
                           Foreground="{DynamicResource SecondaryText}" />
                <TextBlock Text=" | " Foreground="{DynamicResource SecondaryText}" FontSize="11"
                           Visibility="{Binding HasChanges, Converter={StaticResource BoolToVis}}" />
                <TextBlock Text="Unsaved changes" FontSize="11"
                           Foreground="{DynamicResource WarningText}"
                           Visibility="{Binding HasChanges, Converter={StaticResource BoolToVis}}" />
            </StackPanel>
        </Border>

        <!-- Translation Grid -->
        <DataGrid ItemsSource="{Binding Entries}"
                  SelectedItem="{Binding SelectedEntry}"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  CanUserReorderColumns="True"
                  CanUserSortColumns="True"
                  SelectionMode="Single"
                  GridLinesVisibility="All"
                  HorizontalGridLinesBrush="{DynamicResource BorderBrush}"
                  VerticalGridLinesBrush="{DynamicResource BorderBrush}"
                  HeadersVisibility="Column"
                  FontSize="12"
                  VirtualizingPanel.IsVirtualizing="True"
                  VirtualizingPanel.VirtualizationMode="Recycling">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Table" Binding="{Binding TableName}" Width="120"
                                    IsReadOnly="True" />
                <DataGridTextColumn Header="Object" Binding="{Binding ObjectName}" Width="140"
                                    IsReadOnly="True" />
                <DataGridTextColumn Header="Type" Binding="{Binding ObjectType}" Width="70"
                                    IsReadOnly="True" />
                <DataGridTextColumn Header="Property" Binding="{Binding Property}" Width="90"
                                    IsReadOnly="True" />
                <DataGridTextColumn Header="Default" Binding="{Binding DefaultValue}" Width="140"
                                    IsReadOnly="True" />
            </DataGrid.Columns>
        </DataGrid>
    </DockPanel>
</UserControl>
