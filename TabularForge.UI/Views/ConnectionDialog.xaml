<Window x:Class="TabularForge.UI.Views.ConnectionDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:TabularForge.UI.ViewModels"
        Title="Connect to Server"
        Height="520" Width="500"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="{DynamicResource WindowBackground}"
        Foreground="{DynamicResource PrimaryText}">

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Server Address -->
        <StackPanel Grid.Row="0" Margin="0,0,0,12">
            <TextBlock Text="Server Address:" FontWeight="SemiBold" Margin="0,0,0,4" />
            <TextBox Text="{Binding ServerAddress, UpdateSourceTrigger=PropertyChanged}"
                     Padding="6,4" FontSize="13" />
            <TextBlock Text="Examples: localhost, myserver\instance, asazure://region.asazure.windows.net/server"
                       FontSize="10" Foreground="{DynamicResource SecondaryText}" Margin="0,2,0,0" />
        </StackPanel>

        <!-- Server Type -->
        <StackPanel Grid.Row="1" Margin="0,0,0,12">
            <TextBlock Text="Server Type:" FontWeight="SemiBold" Margin="0,0,0,4" />
            <ComboBox ItemsSource="{Binding ServerTypes}"
                      SelectedItem="{Binding ServerType}"
                      Padding="6,4" />
        </StackPanel>

        <!-- Authentication -->
        <StackPanel Grid.Row="2" Margin="0,0,0,12">
            <TextBlock Text="Authentication:" FontWeight="SemiBold" Margin="0,0,0,4" />
            <ComboBox ItemsSource="{Binding AuthenticationTypes}"
                      SelectedItem="{Binding AuthenticationType}"
                      Padding="6,4" />
        </StackPanel>

        <!-- Browse Databases -->
        <StackPanel Grid.Row="3" Margin="0,0,0,8">
            <Button Content="Browse Databases"
                    Command="{Binding BrowseDatabasesCommand}"
                    Padding="12,6" HorizontalAlignment="Left"
                    IsEnabled="{Binding IsBrowsingDatabases, Converter={StaticResource InverseBool}}" />
        </StackPanel>

        <!-- Database List -->
        <GroupBox Grid.Row="4" Header="Databases" Margin="0,0,0,12">
            <Grid>
                <ListBox ItemsSource="{Binding Databases}"
                         SelectedValue="{Binding SelectedDatabaseName}"
                         SelectedValuePath="Name"
                         DisplayMemberPath="Name"
                         Margin="4"
                         Visibility="{Binding IsServerConnected, Converter={StaticResource BoolToVis}}" />
                <TextBlock Text="Click 'Browse Databases' to list available databases."
                           HorizontalAlignment="Center" VerticalAlignment="Center"
                           Foreground="{DynamicResource SecondaryText}"
                           Visibility="{Binding IsServerConnected, Converter={StaticResource InverseBoolToVis}}" />
            </Grid>
        </GroupBox>

        <!-- Status -->
        <TextBlock Grid.Row="5" Text="{Binding StatusMessage}" Margin="0,0,0,12"
                   Foreground="{DynamicResource AccentBrush}"
                   TextWrapping="Wrap" />

        <!-- Buttons -->
        <StackPanel Grid.Row="6" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="Connect" Command="{Binding ConnectCommand}"
                    Padding="20,8" Margin="0,0,8,0"
                    IsDefault="True" />
            <Button Content="Cancel" Padding="20,8"
                    IsCancel="True" Click="CancelButton_Click" />
        </StackPanel>
    </Grid>
</Window>
